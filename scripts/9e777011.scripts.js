!function(){"use strict";var a=angular.module("riverApp",["ngAnimate"]);a.constant("DEBUG",!1),a.config(["$logProvider","DEBUG",function(a,b){a.debugEnabled(b)}])}(),function(){"use strict";angular.module("riverApp").service("$game",function(){function a(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a}var b={},c={name:"The fox",img:"http://placehold.it/350x150&text=fox"},d={name:"The goose",img:"http://placehold.it/350x150&text=goose"},e={name:"A bag of beans",img:"http://placehold.it/350x150&text=beans"};return b.items=[c,d,e],b.rules=[],b.rules[0]={items:[c,d],msg:"The fox will eat the goose!"},b.rules[1]={items:[d,e],msg:"The goose will eat the bag of beans!"},b.getShuffledItems=function(){return a(b.items.slice(0))},b.checkRules=function(a){return b.rules.filter(function(b){return b.items.every(function(b){return a.indexOf(b)>-1})})},b.isWin=function(a){return b.items.every(function(b){return a.indexOf(b)>-1})},b}),angular.module("riverApp").controller("MainCtrl",["$scope","$interval","$timeout","$log","$game","DEBUG",function(a,b,c,d,e,f){function g(b){i(),l=!0,a.message=b}function h(){angular.isDefined(m)||(a.tick(),m=b(a.tick,2e3))}function i(){angular.isDefined(m)&&(b.cancel(m),m=void 0)}function j(b){var c=e.checkRules(b);if(c.length>0){d.debug("Rule violation");var f=c.map(function(a){return a.msg}).join(" ");return a.message="Watch out! "+f,!1}return!0}function k(a,b){return 1===b&&e.isWin(a)?(i(),g("You win!"),!0):!1}a.debug=f;var l=!1;a.cloudLeft="0%",a.sunStyle={top:"50%",left:"20%"},a.moonStyle={top:"50%",left:"20%"},a.worldStyle={backgroundColor:"#87CEEB"},a.spaceStyle={"-webkit-transform:rotate":"rotate(0deg)"},a.time=6,a.tick=function(){d.debug(a.time),19===a.time&&(a.message="Hurry up, the sun is setting"),21===a.time&&(a.message="It's getting too dark to travel");var b=(a.time-6)/12,c=b*Math.PI;a.spaceStyle["-webkit-transform"]="rotate("+c+"rad)",a.sunStyle.top=20*(1-Math.sin(c))+"%",a.sunStyle.left=80*(b+1/6)+"%",a.moonStyle.top=20*(1+Math.sin(c-Math.PI/4))+"%",a.moonStyle.left=80*(b-1/6-1)+"%",a.time+=.5,a.time>=24&&g("Out of time")},a.tick();var m;a.message="Get all the stuff across the river before sunset.",a.boatPosition=0,a.payload="",a.field=[],a.field[0]=e.getShuffledItems(),a.field[1]=[],a.fieldClick=function(b){if(a.payload&&!(a.field[b].length>=3)){var c=a.field[b].length;a.itemClick(c,b)}},a.itemClick=function(b,c){if(!l&&(m||h(),c===a.boatPosition)){var d,e=a.field[c].slice(0);a.payload?(d=e[b],e[b]=a.payload):d=e.splice(b,1)[0],(k(e,c)||j(e))&&(a.field[c]=e,a.payload=d)}},a.row=function(){l||(m||h(),a.boatPosition=0===a.boatPosition?1:0,l=!0,c(function(){l=!1},1500))},a.cloudClick=function(b){a.time=b.offsetX/b.target.offsetWidth*18+5,a.tick()}}])}(),function(){"use strict";angular.module("riverApp").directive("flash",["$timeout",function(a){return{scope:{flash:"=flash"},template:'<div class="message animate-show" ng-show="show" ng-bind="message"></div>',link:function(b){b.show=!1,b.$watch("flash",function(){console.log("msg change"),b.show=!1,a(function(){b.message=b.flash,b.show=!0},100)})}}}])}();