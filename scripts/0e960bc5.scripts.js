!function(){"use strict";var a=angular.module("riverApp",["ngAnimate"]);a.constant("DEBUG",!0),a.config(["$logProvider","DEBUG",function(a,b){a.debugEnabled(b)}])}(),function(){"use strict";angular.module("riverApp").controller("MainCtrl",["$scope","$interval","$timeout","$log","DEBUG",function(a,b,c,d,e){function f(b){h(),l=!0,a.message=b}function g(){angular.isDefined(m)||(a.tick(),m=b(a.tick,2e3))}function h(){angular.isDefined(m)&&(b.cancel(m),m=void 0)}function i(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a}function j(b){var c=q.filter(function(a){return a.fn(b)}).map(function(a){return a.msg});return c.length>0?(d.debug("Rule violation"),a.message=new String("Watch out! "+c.join(" ")),!1):!0}function k(a,b){return 1==b&&3==a.length?(h(),f("You win!"),!0):!1}a.debug=e;var l=!1;a.cloudLeft="0%",a.sunStyle={top:"50%",left:"20%"},a.moonStyle={top:"50%",left:"20%"},a.worldStyle={backgroundColor:"#87CEEB"},a.spaceStyle={"-webkit-transform:rotate":"rotate(0deg)"},a.time=6,a.dayphase="day",a.tick=function(){d.debug(a.time),19==a.time&&(a.message="Hurry up, the sun is setting"),21==a.time&&(a.message="It's getting too dark to travel"),a.dayphase=a.time>19?"night":"day",a.cloudLeft=(a.time-6)/18*100+"%",a.spaceStyle["-webkit-transform"]="rotate("+(a.time-6)/12*180+"deg)";var b=(a.time-6)/12*Math.PI;a.sunStyle.top=20-20*Math.sin(b)+"%",a.sunStyle.left=(a.time-4)/12*80+"%",a.moonStyle.top=20-20*Math.sin(b-Math.PI-Math.PI/4)+"%",a.moonStyle.left=(a.time-4-12-3)/12*80+"%",a.time+=.5,a.time>=24&&f("Out of time")},a.tick();var m;a.message="Get all the stuff across the river before sunset.",a.boatPosition=0,a.payload="";var n={id:"The fox",img:"http://placehold.it/350x150&text=fox"},o={id:"The goose",img:"http://placehold.it/350x150&text=goose"},p={id:"A bag of beans",img:"http://placehold.it/350x150&text=beans"};a.field=[],a.field[0]=i([n,o,p]),a.field[1]=[];var q=[{msg:"The fox will eat the goose!",fn:function(a){return a.indexOf(n)>-1&&a.indexOf(o)>-1}},{msg:"The goose will eat the bag of beans!",fn:function(a){return a.indexOf(p)>-1&&a.indexOf(o)>-1}}];a.fieldClick=function(b){if(!l&&(m||g(),a.payload&&!(a.field[b].length>=3)&&b==a.boatPosition)){var c=a.field[b].slice(0);c.push(a.payload),(k(c,b)||j(c))&&(a.field[b]=c,a.payload=null)}},a.itemClick=function(b,c){if(!l&&(m||g(),c==a.boatPosition)){var d=a.field[c].slice(0);if(a.payload){var e=d[b];d[b]=a.payload}else var e=d.splice(b,1)[0];(k(d,c)||j(d))&&(a.field[c]=d,a.payload=e)}},a.row=function(){l||(m||g(),a.boatPosition=!a.boatPosition,l=!0,c(function(){l=!1},2e3))}}])}(),function(){"use strict";angular.module("riverApp").directive("flash",["$timeout",function(a){return{scope:{flash:"=flash"},template:'<div class="message animate-show" ng-show="show" ng-bind="message"></div>',link:function(b){b.show=!1,b.$watch("flash",function(){console.log("msg change"),b.show=!1,a(function(){b.message=b.flash,b.show=!0},100)})}}}])}();